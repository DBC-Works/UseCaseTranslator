UseCaseTranslatorマニュアル
===========================

　UseCaseTranslatorはYAML書式で記述したユースケースシナリオの集合を次の形式に変換します:

* テストスイートExcelファイル
* Markdownフォーマット

使いかた
--------

　事前に指定の書式のYAMLで記述したユースケースカタログ(後述)を用意し、コマンドラインプロンプトまたはPowerShellコンソールでコマンド"UseCaseTranslator"を実行します。

### コマンド

　出力形式を指定します。次のいずれかを指定します:

* TestSuite - Excelファイルのテストスイート
* UseCaseCatalog - Markdownフォーマットのユースケースドキュメント

　他に"Help"を指定するとヘルプテキストを標準エラー出力に出力します。

### パラメーター

* 追加情報は':'に続けて記述してください。
* パスに空白を含むときは全体をダブルクオーテーション('"')で囲んでください。

### [必須] -i / --input

　ユースケースカタログファイルのパスを指定します。

### [オプション] -o / --output

　変換結果の出力先を指定します。指定のないときはユースケースカタログファイルの存在するディレクトリに出力します。

### [オプション] -a / --apply

　テンプレートとするファイルのパスを指定します。指定のないときは既定のテンプレートを使用します。

　出力形式がTestSuiteのときは単一のテンプレートExcelファイルを指定します。出力形式がUseCaseCatalogのときはユースケースカタログテンプレートファイルのパスとユースケースシナリオセットテンプレートファイルのパスを'|'で結合して指定します。

ユースケースシナリオ仕様
------------------------

　ユースケースシナリオの集合は次の二種類のファイルで記述します:

* ユースケースカタログファイル(単一)
* ユースケースシナリオセットファイル(複数)

　これらのファイルの集合を「ユースケースカタログ」と呼びます。

　マークアップは[YAML](http://www.yaml.org/spec/1.2/spec.html)で行います。[アンカー / エイリアス](http://www.yaml.org/spec/1.2/spec.html#id2765878)も使用できます。うまく使うと記述を省力化できます。

### ユースケースカタログファイル

　ユースケースカタログファイルにはユースケースシナリオセットファイルの参照情報を記述します。

　情報指定マッピングキーは次のとおりです:

#### 「ユースケースシナリオカタログ」

　ユースケースシナリオカタログのタイトルを記述します。

#### 「シナリオセット」

　ユースケースシナリオファイルをシーケンスで記述します。パスを指定しない、または相対パスを指定したときは、参照の基準パスはユースケースカタログファイルの存在するパスとします。

#### 「更新履歴」

　更新情報を指定します。子要素のマッピングキーで版等の情報を、その子要素のマッピングキー「更新日」で更新日を、マッピングキー「概要」で更新情報を記述します。

「更新日」は内部的には文字列として取りあつかいます。

「概要」にはシーケンスを指定できます。

### ユースケースシナリオセットファイル

　ユースケースシナリオセットファイルにはユースケースシナリオを記述します。

　情報指定マッピングキーは次のとおりです:

#### 「シナリオセット」

　ユースケースシナリオセットのタイトルを記述します。

#### 「説明」

　ユースケースシナリオセットの説明を記述します。

#### 「主アクター」

　ユースケースシナリオセットのすべてのシナリオで共通の主アクターを記述します。

#### 「副アクター」

　ユースケースシナリオセットのいずれかのシナリオで関係する副アクターをシーケンスで記述します。

#### 「シナリオ」

　個別のシナリオを記述します。子要素として次のマッピングキーを指定します:

* タイトル - 文字列
* サマリー - 文字列
* 事前条件 - 文字列のシーケンス
* アクション - 子要素としてマッピングキー「操作」「結果」を持つシーケンス。結果には文字列のシーケンスを指定可能

#### 「更新履歴」

　更新情報をユースケースカタログファイルと同じ書式で指定します。

テストスイートテンプレートExcelファイル
---------------------------------------

　デフォルトのテストスイートテンプレートExcelファイルは配布パッケージ"Sample"ディレクトリにファイル名"テストスイートテンプレート.xlsx"で存在します。適用テンプレートを指定する際はこちらのファイルをベースに書式等をカスタマイズしてください。'('')'で囲まれたテキストの存在するセルは値の設定対象で、テキストは処理によって上書きされます。

　なお現在のところ列や行の変更には対応していません。

ユースケーステンプレートファイル
--------------------------------

　デフォルトのユースケーステンプレートファイルは配布パッケージ"Sample"ディレクトリに次のファイル名で存在します:

* ユースケースカタログテンプレートファイル - "ユースケースカタログテンプレート.md"
* ユースケースシナリオセットテンプレートファイル - "ユースケースシナリオセットテンプレート.md"

　適用テンプレートを指定する際はこちらのファイルをベースに書式等をカスタマイズしてください。テンプレートエンジンとして[RazoeEngine](http://antaris.github.io/RazorEngine/)を用いているので、書式はRazorです。プレーンテキストを対象とした場合HTMLほどには賢く解釈されないので、その点は注意してください。

コマンド例
--------

### デフォルトのテンプレートでテストスイートExcelファイルを作成する

```
UseCaseTranslator TestSuite -i:"[ユースケースカタログファイルのパス]"
```

### デフォルトのテンプレートでMarkdownフォーマットのドキュメントを作成する

```
UseCaseTranslator UseCaseCatalog -i:"[ユースケースカタログファイルのパス]"
```

### 指定テンプレートを適用したテストスイートExcelファイルを作成する

```
UseCaseTranslator TestSuite -i:"[ユースケースカタログファイルのパス]" -a:"[テストスイートテンプレートファイルのパス]"
```

### 指定テンプレートを適用したMarkdownフォーマットのドキュメントを作成する

```
UseCaseTranslator TestSuite -i:"[ユースケースカタログファイルのパス]" -a:"[ユースケースカタログテンプレートファイルのパス]|[ユースケースシナリオセットテンプレートファイルのパス]"
```

### 指定ディレクトリにテストスイートExcelファイルを作成する

```
UseCaseTranslator TestSuite -i:"[ユースケースカタログファイルのパス]" -o:"[出力ディレクトリのパス]"
```

FAQ
---

### テストスイートExcelファイル「概要」シートの最終更新日時に設定される日付は?

　ユースケースカタログファイルの更新日時のうちいちばんあたらしいものを設定しています。ユースケースカタログに記述した値は参照しません。

### 例外「シナリオセットファイル{0}の書式に誤りがあります」が報告される

　シナリオセットファイルの書式がYAMLとしては正しくないため解析できません。見直してください。

　代表的なケースとして次が考えられます:

* インデントにタブ(\t)が使われている - YAMLのインデントは空白(U+0020)のみが有効で、タブは利用できません。空白に置き換えてください。
* マッピングの値にYAMLのトークン(':'や'-')が含まれる - 値が文字列であることを明示するためにクオーテーションで囲んでください。
* エイリアスに存在しないアンカーを指定している - エイリアスがアンカーとして存在するか確認してください。

### 例外「ユースケーステンプレートの記述に誤りがあります。」が報告される

　ユースケーステンプレートファイルの書式がRazorとしては正しくないため解析できません。見直してください。

履歴
----

### v0.1.1.0(2016-09-08)

　初回リリース。
